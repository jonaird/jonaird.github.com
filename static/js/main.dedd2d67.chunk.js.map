{"version":3,"sources":["components/Comment.js","components/CommentsContainer.js","components/Post.js","components/LoginAlert.js","components/ReplyForm.js","components/PostForm.js","App.js","serviceWorker.js","index.js"],"names":["Comment","props","tx","Object","objectSpread","commentTree","path","out","s3","h","username","s5","address","in","e","a","showReplyButton","length","userId","s6","subcomments","comments","commentElements","values","sort","b","i","push","react_default","createElement","replyHandler","className","timeago","onClick","decodeURIComponent","s4","CommentContainer","commentsArray","slice","MoneyButton","require","default","convertToHex","str","hex","charCodeAt","toString","Post","_this","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","toggleCommentsHandler","setState","showComments","state","toggleTipHandler","loggedIn","tip","_this2","url","decodeURI","postData","title","showCommentsFor","selfPost","s7","previouslyVoted","voters","includes","showMoneyButton","previous","elapsed","Date","now","Math","round","msPerMinute","msPerHour","msPerDay","timeDifference","timestamp","numVotes","rewardInSatoshis","reward","rewardInDollars","JSON","parse","dollarAmountString","moneyButton","style","height","label","outputs","amount","currency","type","script","to","localStorage","getItem","editable","replyButton","tipToggle","cursor","window","open","toggleComments","width","display","alignItems","justifyContent","React","Component","Number","prototype","countDecimals","floor","valueOf","split","LoginAlert","onPaymentHandler","payment","input","setItem","changingUsername","priceInput","loginHandler","console","log","inputOnChangeHandler","event","target","value","priceInputChangeHandler","validPrice","isNaN","price","votePriceChangeHandler","paymentAmount","disableMoneyButton","alertHeight","header","login","changingVotePrice","vote","validPriceChange","loginInfoClass","loginMessage","voteInput","loginInfo","class","usernameInput","maxLength","name","data-name","placeholder","id","onChange","maxlength","buttonClass","xHandler","LoginAlert_MoneyButton","onPayment","disabled","ReplyForm","inputChangeHandler","reply","replyingTo","hideReply","defaultValue","ReplyForm_MoneyButton","encodeURIComponent","PostForm","urlChangeHandler","titleChangeHandler","postPriceChangeHandler","postPrice","defaultPriceHandler","document","getElementsByClassName","opReturn","opreturn","encodeURI","checkedPrice","required","defineProperty","PostForm_MoneyButton","finishSubmitHandler","chunkString","len","_offset","_size","ceil","_ret","Array","_i","substring","App","processPostsVotes","transactions","posts","votes","filter","valid","RegExp","test","secondOutput","postTxid","correctAddress","correctAddressSecondOutput","voterId","prevVoters","selfVote","v","postsArray","loadPosts","b64","btoa","stringify","q","find","out.s1","out.s2","limit","dateRange","fetch","headers","key","then","r","json","result","t","createPostVoteSocket","EventSource","onmessage","data","hideLoginAlert","showLoginAlert","submitHandler","posting","replying","mode","switchMode","votePrice","hideReplyFormHandler","postTransaction","loadComments","processComments","maxDepth","rootPath","sendAddress","correctSendAddress","selfComment","pathArray","query","out.s3","$regex","commentsTransactions","createCommentsSocket","socketQuery","commentsSocket","updatedTransactions","concat","toggleDateRange","newState","showDropdown","defaultVotePrice","numTopPosts","postElements","pop","Post_Post","headerRight","dropdown","charSet","content","Helmet","src","paddingBottom","LoginAlert_LoginAlert","PostForm_PostForm","ReplyForm_ReplyForm","padding","paddingRight","margin","data-address","Boolean","location","hostname","match","ReactDOM","render","src_App_0","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.dedd2d67.chunk.js","sourcesContent":["import React from 'react';\n\nexport default function Comment(props) {\n\n  var tx={...props.commentTree.tx};\n\n  var path = tx.out[0].s3+tx.tx.h;\n  var username = tx.out[0].s5;\n  var address = tx.in[0].e.a\n  var showReplyButton = path.length/64<6 && props.userId!=tx.out[0].s6\n\n  var subcomments = {...props.commentTree};\n  delete subcomments.tx;\n  delete subcomments.comments;\n\n  subcomments = Object.values(subcomments);\n\n  var commentElements=[];\n\n  subcomments.sort(function(a,b){\n    return b.comments-a.comments;\n  })\n\n  for(let i=0;i<subcomments.length;i++){\n    commentElements.push(<Comment replyHandler={props.replyHandler} userId={props.userId} commentTree={subcomments[i]}/>)\n  }\n  \n\n  \n  return (\n    <div className=\"comment\">\n      <div className=\"comment-metadata\">\n\n        <div className=\"metadata\">{tx.out[0].s5}</div>\n        <div className=\"metadata\">{tx.timeago}</div>\n        {showReplyButton?<div className=\"metadata metadata-button\" onClick={() => props.replyHandler(path, username, address )}> reply</div>:null}\n      </div>\n      <div className=\"comment-content\">{decodeURIComponent(tx.out[0].s4)}</div>\n      {commentElements}\n    </div>\n  )\n}","import React from 'react';\nimport Comment from './Comment';\n\n\nexport default function CommentContainer(props){\n\n    var commentsArray = props.comments.slice();\n\n    commentsArray.sort(function (a,b){\n      return b.comments - a.comments;\n    })\n\n    var commentElements = [];\n    if(props.comments){\n      for(let i=0;i<props.comments.length;i++){\n        commentElements.push(<Comment replyHandler={props.replyHandler} userId={props.userId} commentTree={commentsArray[i]}/>)\n      }\n    }\n    \n\n    return(\n        <div className=\"comments-container\">\n          {commentElements}\n          {commentElements.length==0?\"No comments!\":null}\n        </div>\n    )\n}","import React from 'react';\nimport Comment from './Comment';\n\nimport CommentContainer from './CommentsContainer';\nlet MoneyButton = require('@moneybutton/react-money-button').default\n\nfunction convertToHex(str) {\n  var hex = '';\n  for (var i = 0; i < str.length; i++) {\n    hex += '' + str.charCodeAt(i).toString(16);\n  }\n  return hex;\n}\n\nfunction timeDifference(previous) {\n\n  var msPerMinute = 60 * 1000;\n  var msPerHour = msPerMinute * 60;\n  var msPerDay = msPerHour * 24;\n  var msPerMonth = msPerDay * 30;\n  var msPerYear = msPerDay * 365;\n\n  var elapsed = Date.now() - previous;\n\n  if (elapsed < msPerMinute) {\n       return Math.round(elapsed/1000) + ' seconds ago';   \n  }\n\n  else if (elapsed < msPerHour) {\n       return Math.round(elapsed/msPerMinute) + ' minutes ago';   \n  }\n\n  else if (elapsed < msPerDay ) {\n       return Math.round(elapsed/msPerHour ) + ' hours ago';   \n  }\n\n  else if (elapsed < msPerMonth) {\n      return Math.round(elapsed/msPerDay) + ' days ago';   \n  }\n\n  else if (elapsed < msPerYear) {\n      return Math.round(elapsed/msPerMonth) + ' months ago';   \n  }\n\n  else {\n      return Math.round(elapsed/msPerYear ) + ' years ago';   \n  }\n}\n\nexport default class Post extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n\n      showComments: false,\n      tip: false\n    }\n  }\n\n\n\n\n\n  toggleCommentsHandler = () => {\n    this.setState({\n      showComments: !this.state.showComments\n    })\n  }\n\n  toggleTipHandler=()=>{\n    if(this.props.loggedIn){\n      this.setState({ tip: !this.state.tip })\n    } else {\n      this.props.replyHandler()//prompts user to Login\n    }\n  }\n\n\n\n  render() {\n\n    var url = decodeURI(this.props.postData.tx.out[0].s5)\n    var title = decodeURIComponent(this.props.postData.tx.out[0].s4)\n    var username = this.props.postData.tx.out[0].s6\n    var showComments = this.props.showCommentsFor == this.props.postData.tx.tx.h\n    var selfPost = this.props.postData.tx.out[0].s7 == this.props.userId;\n    var previouslyVoted = this.props.postData.voters.includes(this.props.userId);\n    var showMoneyButton= !selfPost&& !previouslyVoted \n    var timeago;\n    this.props.postData.tx.timeago? timeago=this.props.postData.tx.timeago:timeago =timeDifference(this.props.postData.tx.timestamp);\n    var numVotes = this.props.postData.voters.length+1\n\n\n    var rewardInSatoshis = this.props.postData.reward;\n    var rewardInBitcoin = JSON.parse((rewardInSatoshis / 100000000));\n    var rewardInDollars = rewardInBitcoin*200;\n    var dollarAmountRounded= Math.round(rewardInDollars*100)/100\n    var dollarAmountString = dollarAmountRounded.toString();\n    var moneyButton = (<div style={{ height: 50 }} />)\n\n    if (this.props.loggedIn && !this.state.tip) {\n      moneyButton = (<MoneyButton\n        label='vote'\n\n        outputs={[\n          {\n            amount: 0,\n            currency: 'BSV',\n            type: 'SCRIPT',\n            script: 'OP_RETURN ' + convertToHex('13beK8bifnhuC8pawWvMrPCaWoTQi5LnZf') + ' ' + convertToHex('post/vote') + ' ' + convertToHex('vote') + ' ' + convertToHex(this.props.postData.tx.tx.h) + ' ' + convertToHex(this.props.userId)\n\n          }, {\n            to: this.props.postData.tx.in[0].e.a,\n            amount: localStorage.getItem('votePrice'),\n            currency: 'USD',\n\n\n          }\n\n        ]}\n\n\n      />)\n    } else if (this.props.loggedIn && this.state.tip) {\n      moneyButton = (<MoneyButton\n        to={this.props.postData.tx.in[0].e.a}\n        amount='0.01'\n        currency='BSV'\n        editable={true}\n      />)\n    }\n\n\n    if (dollarAmountString.length == 1) {\n      dollarAmountString += '.00'\n    } \n    // else if (rewardInBitcoin.length < 10) {\n    //   while (rewardInBitcoin.length < 10) {\n    //     rewardInBitcoin += '0'\n    //   }\n    // }\n\n\n    var replyButton = (<div className=\"metadata metadata-button\" onClick={() => this.props.replyHandler(this.props.postData.tx.tx.h, username, this.props.postData.tx.in[0].e.a)}>reply</div>\n    )\n    var tipToggle = (<div className=\"metadata metadata-button\" onClick={this.toggleTipHandler}>{this.state.tip ? 'vote' : 'tip'}</div>\n    )\n\n    return (\n\n      <div className=\"post-container\"  >\n        <div className='post'>\n          <div>\n            <div className=\"post-data\">\n              <div className=\"reward\">${dollarAmountString} <strong></strong></div>\n              <div className=\"post-title\" style={{ cursor: 'pointer' }} onClick={() => window.open(url)}>{title}</div>\n            </div>\n            <div className=\"post-metadata\">\n              <div className=\"metadata\"> ({numVotes} vote{numVotes==1?null:'s'})</div>\n              <div className=\"metadata\"> {timeago}</div>\n              <div className=\"metadata\">{username}</div>\n\n              <div className=\"metadata\" style={{ cursor: 'pointer' }} onClick={() => this.props.toggleComments(this.props.postData.tx)} > {showComments ? 'hide comments ▼' : 'show comments ▶'}</div>\n              \n              {selfPost ? null : [replyButton, tipToggle]}\n            </div>\n          </div>\n          {!showMoneyButton && !this.state.tip? <div style={{ height: 50, width:120, display:'flex',alignItems:'center', justifyContent:'center' }}>{previouslyVoted?\"Voted! 🗳️\":null}</div> : <div style={{ width: this.state.tip ? 150 : 120, }} >\n            {moneyButton}\n          </div>}\n\n        </div>\n\n        {showComments ? <CommentContainer replyHandler={this.props.replyHandler} userId={this.props.userId} comments={this.props.comments} /> : null}\n      </div>\n\n\n\n    );\n  }\n}\n\n","import React from 'react';\nimport Cookies from 'universal-cookie';\nlet MoneyButton = require('@moneybutton/react-money-button').default\n\nNumber.prototype.countDecimals = function () {\n  if(Math.floor(this.valueOf()) === this.valueOf()) return 0;\n  return this.toString().split(\".\")[1].length || 0; \n}\n\nexport default class LoginAlert extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      input: '',\n      priceInput: '',\n      validPrice: false\n    }\n  }\n\n  onPaymentHandler = (payment) => {\n\n    if (this.state.input != '') {\n      localStorage.setItem('userId', payment.userId.toString(), { path: '/' });\n      localStorage.setItem('username', this.state.input, { path: '/' });\n      //checks if change price alert\n      if(!this.props.changingUsername&&!this.props.changingUsername) {\n        localStorage.setItem('votePrice',this.state.priceInput);}\n      this.props.loginHandler();\n    }\n\n    console.log(payment.userId)\n    console.log(payment);\n  }\n\n  inputOnChangeHandler = (event) => {\n    this.setState({\n      input: event.target.value\n    })\n  }\n\n  priceInputChangeHandler = event =>{\n    var NaN = isNaN(event.target.value);\n    \n    var validPrice=false;\n    if(!NaN){\n      var price = JSON.parse(event.target.value)\n      if(price.countDecimals()<3 & price>=0.01){\n        validPrice=true;\n      }\n    } \n    this.setState({\n      priceInput: event.target.value,\n      validPrice\n      \n    })\n  }\n\n  votePriceChangeHandler=()=>{\n    localStorage.setItem('votePrice',this.state.priceInput);\n    this.props.votePriceChangeHandler();\n  }\n\n\n  render() {\n    console.log(this.props.changingUsername);\n    var paymentAmount;\n    var login = !this.props.changingUsername & !this.props.changingVotePrice;\n    var username = this.props.changingUsername;\n    var vote = this.props.changingVotePrice;\n    var validPriceChange = vote && this.state.validPrice && this.state.priceInput!='';\n\n    var disableMoneyButton;\n    if(login){\n      disableMoneyButton=!(this.state.validPrice && this.state.input!=='')\n    } else {\n      disableMoneyButton=!(username&&this.state.input!=='')\n    }\n    \n   \n\n    username ? paymentAmount = '1' : paymentAmount = '0.01';\n    var alertHeight;\n    if (login) {\n      alertHeight = 230\n    } else if (username) {\n      alertHeight = 140\n    } else {\n      alertHeight = 150\n    }\n    console.log(alertHeight)\n\n    var header;\n    if (login) {\n      header = 'Login';\n    } else if (username) {\n      header = \"Change Username\";\n    } else {\n      header = \"Change Vote Price\";\n    }\n\n    var loginInfoClass = 'login-info';\n    var loginMessage = \"*On bsvnews, you can upvote other users' content. Set the default amount of money you would like to give them for each upvote. You can change this later. Your default price must be $0.01 or higher.\"\n    if ((login || vote) && (this.state.validPrice == false & this.state.priceInput!='')) {\n      loginInfoClass += ' login-info-red';\n      loginMessage = \"*Please enter a valid vote price (ex. 0.25).\"\n    }\n    var loginInfo = (\n      <div class={loginInfoClass}>{loginMessage}</div>\n\n    )\n\n    var usernameInput = (\n      <input type=\"text\" class=\"login-username w-input\" maxLength=\"15\" name=\"name-2\"\n        data-name=\"Name 2\" placeholder=\"Desired username\" id=\"name-2\"\n        onChange={this.inputOnChangeHandler} />\n    )\n\n    var voteInput;\n    if (login) {\n      voteInput = (\n        <div className=\"vote-price-container\">\n          <input type=\"text\" onChange={this.priceInputChangeHandler}\n          class=\"login-username w-input\" maxlength=\"5\" name=\"name-2\" data-name=\"Name 2\"\n          placeholder=\"Default vote price (USD)\" id=\"name-2\" />\n        </div>\n        \n      )\n    } else if (vote) {\n      var buttonClass;\n      this.state.validPrice?buttonClass='header-button':buttonClass='header-button button-greyed'\n      voteInput = (\n      <div className='vote-price-container'>\n        <input type=\"text\" onChange={this.priceInputChangeHandler}\n          class=\"login-username w-input vote-price\" maxlength=\"5\" name=\"name-2\" data-name=\"Name 2\"\n          placeholder=\"Default vote price (USD)\" id=\"name-2\" />\n        <div className={buttonClass} onClick={validPriceChange?this.votePriceChangeHandler:()=>null}>\n          <div className='header-button-text dropdown-text'>set price</div>\n        </div>\n\n      </div>\n      );\n\n    }\n\n    return (\n      <div class=\"login-container\">\n        <div class=\"login-alert w-form\" style={{ height: alertHeight }}>\n          <form id=\"email-form-3\" name=\"email-form-3\" data-name=\"Email Form 3\" class=\"login-form\">\n\n            <div class=\"x-container\" >\n              <div className=\"div-block-4\">\n                <div class=\"login-title\">{header}</div>\n              </div>\n\n              <div class=\"login-cancel\" onClick={this.props.xHandler}>X</div>\n            </div>\n            <form id=\"email-form-3\" name=\"email-form-3\" data-name=\"Email Form 3\" class=\"login-form\">\n              <div class=\"inputs-container\">\n                {login || username ? usernameInput : null}\n                {login || vote ? [voteInput, loginInfo] : null}\n\n\n              </div>\n            </form>\n\n            {login  || this.props.changingUsername ? <div className=\"mb-container\" ><MoneyButton\n              to='112'\n              label='submit'\n              amount={paymentAmount}\n              currency='USD'\n              onPayment={this.onPaymentHandler}\n              disabled={disableMoneyButton}\n            /></div> : null}\n          </form>\n\n        </div>\n      </div>\n\n    );\n  }\n}\n\n{/* <div className=\"login-container\">\n        <div className=\"login-alert w-form\">\n          <form id=\"email-form-3\" name=\"email-form-3\" data-name=\"Email Form 3\" className=\"login-form\">\n            <div className=\"div-block-2\" onClick={this.props.xHandler}>\n              <div className=\"login-cancel\" >X</div>\n            </div>\n            <div className=\"login-title\" style={{ pointerEvents: 'none' }} >Login</div>\n            <input\n              onChange={this.inputOnChangeHandler}\n              type=\"text\"\n              className=\"login-username w-input\"\n              maxLength={256} name=\"name-2\"\n              data-name=\"Name 2\"\n              placeholder=\"Desired Username\" id=\"name-2\" />\n            <div className=\"mb-container\" ><MoneyButton\n              to='112'\n              amount={paymentAmount}\n              currency='USD'\n              onPayment={this.onPaymentHandler}\n            /></div>\n          </form>\n\n        </div>\n      </div> */}","import React from 'react';\nlet MoneyButton = require('@moneybutton/react-money-button').default\n\n var convertToHex=(str)=> {\n  var hex = '';\n  for (var i = 0; i < str.length; i++) {\n      hex += '' + str.charCodeAt(i).toString(16);\n  }\n  return hex;\n}\n\n\nexport default class ReplyForm extends React.Component {\n  constructor(props){\n    super(props);\n    this.state={\n      reply:''\n    }\n\n  }\n\n  inputChangeHandler=(e)=>{\n    this.setState({\n      reply:e.target.value\n    })\n    \n  }\n\n  render() {\n    return (\n      <div className=\"new-reply-container\">\n        <div className=\"new-reply-form w-form\">\n          <form id=\"email-form-2\" name=\"email-form-2\" data-name=\"Email Form 2\" className=\"form-2\">\n            <div className=\"div-block\">\n              <div>Replying to: {this.props.replyingTo.username}</div>\n              <div className=\"login-cancel\" onClick={this.props.hideReply}>X</div>\n            </div>\n            <textarea onChange={this.inputChangeHandler} id=\"field\" name=\"field\" placeholder=\"Example Text\" maxLength={5000} className=\"textarea w-input\" defaultValue={\"\"} />\n            <MoneyButton\n              outputs={[\n                {\n                  amount: 0,\n                  currency: 'BSV',\n                  type: 'SCRIPT',\n                  script: 'OP_RETURN ' + convertToHex('13beK8bifnhuC8pawWvMrPCaWoTQi5LnZf') + ' ' + convertToHex('comment') + ' ' + convertToHex(this.props.replyingTo.path) + ' ' + convertToHex(encodeURIComponent(this.state.reply)) + ' ' + convertToHex(this.props.username) +' ' + convertToHex(this.props.userId)\n\n                }, {\n                  to: this.props.replyingTo.address,\n                  amount: '0.01',\n                  currency: 'USD'\n\n                }\n              ]}\n              onPayment={this.props.hideReply}\n\n            />\n          </form>\n        </div>\n      </div>\n    )\n  }\n}","import React from 'react';\nlet MoneyButton = require('@moneybutton/react-money-button').default\n\nfunction convertToHex(str) {\n    var hex = '';\n    for (var i = 0; i < str.length; i++) {\n        hex += '' + str.charCodeAt(i).toString(16);\n    }\n    return hex;\n}\n\nNumber.prototype.countDecimals = function () {\n    if (Math.floor(this.valueOf()) === this.valueOf()) return 0;\n    return this.toString().split(\".\")[1].length || 0;\n}\n\n\nexport default class PostForm extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            url: '',\n            title: '',\n            opReturn: '',\n            postPrice: '',\n            validPrice: false\n\n        }\n    }\n\n\n\n\n    urlChangeHandler = (e) => {\n        this.setState({\n            url: e.target.value\n        })\n    }\n\n    titleChangeHandler = (e) => {\n        this.setState({\n            title: e.target.value\n        })\n\n    }\n\n    postPriceChangeHandler = (e) => {\n        var NaN = isNaN(e.target.value);\n        var validPrice = false;\n        if (!NaN) {\n            var price = JSON.parse(e.target.value)\n            if (price.countDecimals() < 3 & price >= 0.01) {\n                validPrice = true;\n            }\n        }\n        this.setState({\n            postPrice: e.target.value,\n            validPrice\n\n        })\n\n    }\n\n\n    defaultPriceHandler = () => {\n        document.getElementsByClassName('price-field')[0].value = localStorage.getItem('votePrice');\n        this.setState({\n            validPrice: true,\n            postPrice: localStorage.getItem('votePrice')\n        });\n    }\n\n    render() {\n        var opreturn = convertToHex('13beK8bifnhuC8pawWvMrPCaWoTQi5LnZf') + ' ' + convertToHex('post/vote') + ' ' + convertToHex('post') + ' ' + convertToHex(encodeURIComponent(this.state.title)) + ' ' + convertToHex(encodeURI(this.state.url)) + ' ' + convertToHex(this.props.username) + ' ' + convertToHex(this.props.userId)\n        var checkedPrice=null;\n       \n        if(this.state.validPrice){\n            checkedPrice=this.state.postPrice\n        }\n        return (\n            <div className=\"new-post w-form\">\n                <form id=\"email-form\" name=\"email-form\" data-name=\"Email Form\" className=\"form\">\n                    <input onChange={this.titleChangeHandler} type=\"text\" className=\"text-field w-input\" maxLength={256} name=\"name\" data-name=\"Name\" placeholder=\"Post Title\" id=\"name\" />\n                    <input onChange={this.urlChangeHandler} type=\"email\" className=\"text-field w-input\" maxLength={256} name=\"email\" data-name=\"Email\" placeholder=\"Post URL\" id=\"email\" required />\n                    <div class=\"post-price-container\">\n                        <input type=\"text\" id='postPriceInput' onChange={this.postPriceChangeHandler} class=\"text-field price-field w-input\" maxlength=\"256\"\n                            name=\"name-2\" data-name=\"Name 2\" placeholder=\"Vote Price (USD)\" id=\"name-2\" />\n                        <div class=\"header-button\" onClick={this.defaultPriceHandler}>\n                            <div class=\"header-button-text dropdown-text\">default price</div>\n                        </div>\n                    </div>\n                    <div className=\"text-block-7\">*Enter in the price of your initial vote on your own post. You can think of it as paying for a form of advertisement as your post may get noticed more. Must be more than $0.01.</div>\n                    <MoneyButton\n                        outputs={[\n                            {\n                                amount: 0,\n                                currency: 'BSV',\n                                type: 'SCRIPT',\n                                script: 'OP_RETURN ' + opreturn\n\n                            }, {\n                                to: '1JM394PQB47chcs49PCe3JETLDaBwzieBP',\n                                amount: checkedPrice,\n                                currency: 'USD'\n\n                            }\n                        ]}\n                        \n                        label='submit'\n                        disabled={!this.state.validPrice}\n\n\n                        onPayment={this.props.finishSubmitHandler}\n                    />\n                </form>\n\n            </div>\n        );\n    }\n}","import React, { Component } from 'react';\nimport './App.css';\nimport Post from './components/Post.js';\nimport Cookies from 'universal-cookie';\nimport LoginAlert from './components/LoginAlert';\nimport ReplyForm from './components/ReplyForm';\nimport PostForm from './components/PostForm';\nimport {Helmet} from 'react-helmet';\nlet MoneyButton = require('@moneybutton/react-money-button').default\n\nfunction chunkString(str, len) {\n  var _size = Math.ceil(str.length / len),\n    _ret = new Array(_size),\n    _offset\n    ;\n\n  for (var _i = 0; _i < _size; _i++) {\n    _offset = _i * len;\n    _ret[_i] = str.substring(_offset, _offset + len);\n  }\n\n  return _ret;\n}\n\nfunction validURL(str) {\n  var pattern = new RegExp('^(https?:\\\\/\\\\/)?' + // protocol\n    '((([a-z\\\\d]([a-z\\\\d-]*[a-z\\\\d])*)\\\\.)+[a-z]{2,}|' + // domain name\n    '((\\\\d{1,3}\\\\.){3}\\\\d{1,3}))' + // OR ip (v4) address\n    '(\\\\:\\\\d+)?(\\\\/[-a-z\\\\d%_.~+]*)*' + // port and path\n    '(\\\\?[;&a-z\\\\d%_.~+=-]*)?' + // query string\n    '(\\\\#[-a-z\\\\d_]*)?$', 'i'); // fragment locator\n  return !!pattern.test(str);\n}\n\n\nclass App extends Component {\n\n\n  constructor(props) {\n    super(props);\n    //this.cookies = new Cookies();\n    const username = localStorage.getItem('username');\n    const userId = localStorage.getItem('userId');\n    const votePrice = localStorage.getItem('votePrice');\n    console.log(userId,username);\n\n    var state = {\n      showLoginAlert: false,\n      showDropdown:false,\n      changingUsername:false,\n      changingVotePrice:false,\n      defaultVotePrice:null,\n      loggedIn: false,\n      replying: false,\n      replyingTo: null,\n      posting: false,\n      showCommentsFor: null,\n      commentsTransactions: null,\n      comments: null,\n      mode: 'top',\n      dateRange: 'today',\n      userId: null,\n      username: null,\n      transactions: [],\n      posts: []\n    }\n\n    if (username && userId && votePrice) {\n      state.username = username;\n      state.userId = userId;\n      state.votePrice= votePrice;\n      state.loggedIn = true;\n    }\n    this.state = state;\n    this.loadPosts();\n    this.createPostVoteSocket();\n\n  }\n\n\n\n\n\n  processPostsVotes = (transactions) => {\n    //make sure there are the right number of pushdata's\n\n    var posts = {};\n    var votes = [];\n\n    //filter invalid tx's and separate posts from votes\n    var transactions = transactions.filter(tx => {\n      var valid = false\n      if (tx.out[0].s3) {\n        if (tx.out[0].s3 == 'post') {\n          //checks for the right number of pushdata's\n          valid = tx.out[0].s7 && (validURL(decodeURI(tx.out[0].s5)) || decodeURI(tx.out[0].s5).includes('medium'))\n          if (valid) {\n            //donation sometimes happens in second output\n            var secondOutput = false\n            if (tx.out[2]) {\n              secondOutput = tx.out[2].e.a == '1JM394PQB47chcs49PCe3JETLDaBwzieBP'\n            }\n            //checks both outputs for donation\n            var donated = tx.out[1].e.a == '1JM394PQB47chcs49PCe3JETLDaBwzieBP' | secondOutput\n            //adds valid post to posts object\n            if (donated) {\n              posts[tx.tx.h] = { tx: tx, reward: 0, voters: [] }\n\n            }\n\n          }\n\n\n        } else if (tx.out[0].s3 == 'vote') {\n          valid = tx.out[0].s5;\n          if (valid) {\n            votes.push(tx);\n\n          }\n\n        }\n\n      }\n      return valid;\n    })\n    console.log('votes', votes)\n    console.log(posts);\n\n    //old code for processing transactions. very inefficient\n\n    // let posts = {}\n    // for (let i = 0; i < transactions.length; i++) {\n\n    //   if (transactions[i].out[0].s3 == 'post') {\n    //     var secondOutput = false\n    //     if (transactions[i].out[2]) {\n    //       secondOutput = transactions[i].out[2].e.a == '1JM394PQB47chcs49PCe3JETLDaBwzieBP'\n    //     }\n    //     var donated = transactions[i].out[1].e.a == '1JM394PQB47chcs49PCe3JETLDaBwzieBP' | secondOutput\n    //     if (donated) {\n    //       posts[transactions[i].tx.h] = { tx: transactions[i], reward: 0, voters: [] }\n\n    //     }\n    //   }\n    // }\n\n    // for (let i = 0; i < posts.length; i++) {\n\n\n    // }\n\n    //loop through votes to assign them properly\n    for (let i = 0; i < votes.length; i++) {\n      //does vote have corresponding post?\n      var postTxid = votes[i].out[0].s4\n      if (posts[postTxid]) {\n        var correctAddress = posts[postTxid].tx.in[0].e.a == votes[i].out[1].e.a;\n        var correctAddressSecondOutput = false;\n        if (votes[i].out[2]) {\n          correctAddressSecondOutput = posts[postTxid].tx.in[0].e.a == votes[i].out[2].e.a;\n        }\n\n        correctAddress = correctAddress || correctAddressSecondOutput;\n        var voterId = votes[i].out[0].s5;\n        var prevVoters = posts[postTxid].voters;\n        var selfVote = voterId == posts[postTxid].tx.out[0].s7;\n\n        if (correctAddress && !prevVoters.includes(voterId) && !selfVote) {\n          //tabulating upvote total\n          correctAddressSecondOutput ? posts[postTxid].reward += votes[i].out[2].e.v : posts[postTxid].reward += votes[i].out[1].e.v;\n          prevVoters.push(voterId) // keeps track of unique voters\n\n        }\n      }\n    }\n\n\n\n    //start comment out\n    // var postsKeys = Object.keys(posts);\n\n    // //loop through posts\n    // for (let i = 0; i < postsKeys.length; i++) {\n    //   //loop through transactions to find upvotes for specific post\n    //   for (let j = 0; j < transactions.length; j++) {\n    //     //is upvote and is upvote for current post?\n    //     if (transactions[j].out[0].s4 == postsKeys[i]) {\n    //       var correctAddress = posts[postsKeys[i]].tx.in[0].e.a == transactions[j].out[1].e.a;\n\n    //       var correctAddressSecondOutput = false;\n    //       if (transactions[j].out[2]) {\n    //         correctAddressSecondOutput = posts[postsKeys[i]].tx.in[0].e.a == transactions[j].out[2].e.a;\n    //       }\n\n    //       var voterId = transactions[j].out[0].s5;\n    //       var prevVoters = posts[postsKeys[i]].voters;\n    //       var selfVote = voterId == posts[postsKeys[i]].tx.out[0].s7;\n    //       //TODO: var selfVote = do a self vote check\n\n    //       if (correctAddress && !prevVoters.includes(voterId) && !selfVote) {\n    //         //tabulating upvote total\n    //         posts[postsKeys[i]].reward += transactions[j].out[1].e.v;\n    //         prevVoters.push(voterId) // keeps track of unique voters\n\n    //       } else if (correctAddressSecondOutput && !prevVoters.includes(voterId) && !selfVote) {\n    //         posts[postsKeys[i]].reward += transactions[j].out[2].e.v;\n    //         prevVoters.push(voterId)\n    //       }\n\n    //     }\n    //   }\n    // }\n\n    var postsArray = Object.values(posts)\n\n\n\n\n    this.setState({\n      posts: postsArray\n    })\n\n  }\n\n\n\n  loadPosts = () => {\n\n\n    var query = { \"v\": 3, \"q\": { \"find\": { \"out.s1\": \"13beK8bifnhuC8pawWvMrPCaWoTQi5LnZf\", \"out.s2\": \"post/vote\" }, \"limit\": 1000 } };\n    var b64 = btoa(JSON.stringify(query));\n    var url;\n    if (this.state.dateRange == \"today\") {\n      url = \"https://chronos.bitdb.network/q/1P6o45vqLdo6X8HRCZk8XuDsniURmXqiXo/\" + b64;\n    } else {\n      url = \"https://weekly.bitdb.network/q/12KQyEvGbHcJmavgmB1jDeTSJhJTzQ5ePg/\" + b64;\n\n    }\n\n\n    var header = {\n      headers: { key: \"1EsRL44h3xNm8G4hT35ns3nNPicAHWAftc\" }\n    };\n\n    fetch(url, header).then(function (r) {\n      return r.json()\n    }).then((r) => {\n      var result = JSON.stringify(r, null, 2);\n      result = JSON.parse(result);\n\n      var transactions = result.t;\n\n      console.log(transactions);\n\n      this.processPostsVotes(transactions);\n      this.setState({\n        transactions\n      })\n\n\n    })\n  }\n\n  createPostVoteSocket = () => {\n\n    var socketQuery = { \"v\": 3, \"q\": { \"find\": { \"out.s1\": \"13beK8bifnhuC8pawWvMrPCaWoTQi5LnZf\", \"out.s2\": \"post/vote\" } } };\n\n    var b64 = btoa(JSON.stringify(socketQuery))\n    // Subscribe to EventSource\n    var url = \"https://chronos.bitdb.network/s/1P6o45vqLdo6X8HRCZk8XuDsniURmXqiXo/\" + b64;\n    var socket = new EventSource(url)\n    // Handle new messages\n\n    socket.onmessage = (e) => {\n\n      var transactions = JSON.parse(JSON.stringify(JSON.parse(e.data), null, 2)).data\n      if (transactions.length > 0) {\n        this.loadPosts()\n      }\n\n      // var updatedTransactions = this.state.transactions.concat(transactions)\n      // this.processPostsVotes(updatedTransactions)\n      // this.setState({\n      //   transactions: updatedTransactions\n      // });\n\n\n\n\n    }\n\n  }\n\n\n\n  hideLoginAlert = () => {\n    this.setState({\n      showLoginAlert: false\n    })\n  }\n\n  submitHandler = () => {\n    if (!this.state.loggedIn) {\n      this.setState({\n        showLoginAlert: true\n      })\n    } else if (this.state.posting == true) {\n      this.setState({\n        posting: false\n      })\n    }\n    else {\n      this.setState({\n        replying: false,\n        posting: true,\n        mode: 'new',\n        dateRange: 'today'\n      }, this.loadPosts\n      );\n\n    }\n  }\n\n  switchMode = () => {\n    this.loadPosts();\n    if (this.state.mode == 'top') {\n      this.setState({ mode: 'new' })\n    } else {\n      this.setState({ mode: 'top' })\n    }\n  }\n\n  loginHandler = () => {\n    this.setState({\n      loggedIn: true,\n      userId: localStorage.getItem('userId'),\n      username: localStorage.getItem('username'),\n      votePrice:localStorage.getItem('votePrice')\n    })\n    this.hideLoginAlert();\n  }\n\n  replyHandler = (path, username, address) => {\n    if (this.state.loggedIn) {\n      this.setState({\n        replying: true,\n        replyingTo: {\n          path,\n          username,\n          address\n        }\n      })\n    } else {\n      this.setState({ showLoginAlert: true });\n    }\n\n  }\n\n  hideReplyFormHandler = () => {\n    this.setState({\n      replying: false,\n      replyingTo: null\n    })\n  }\n\n  toggleCommentsHandler = (postTransaction) => {\n    if (this.state.showCommentsFor == postTransaction.tx.h) {\n      // this.commentsSocket = null;\n      this.setState({\n        showCommentsFor: null\n      })\n    } else {\n      //this.commentsSocket = null;\n      this.loadComments(postTransaction);\n\n\n\n    }\n\n\n  }\n\n  processComments = (transactions, postTransaction) => {\n    var transactions = transactions.filter(tx => {\n      var valid = false\n      if (tx.out[0].s6) {\n        valid = true\n      }\n\n\n      return valid;\n    })\n\n\n    var comments = {};\n    var maxDepth = 0;\n    var rootPath = postTransaction.tx.h;\n    var sendAddress = postTransaction.in[0].e.a\n\n\n    //loops to find comments of depth=1 and adds to comments object\n    for (let i = 0; i < transactions.length; i++) {\n      var correctSendAddress = (sendAddress == transactions[i].out[1].e.a) || (sendAddress == transactions[i].out[2].e.a);\n      var selfComment = transactions[i].out[0].s6 == postTransaction.out[0].s7;\n\n      if (transactions[i].out[0].s3.length / 64 > maxDepth) {\n        maxDepth = transactions[i].out[0].s3.length / 64;\n      }\n      if (transactions[i].out[0].s3 == postTransaction.tx.h && correctSendAddress && !selfComment) {\n\n        comments[transactions[i].tx.h] = {\n          tx: transactions[i],\n          comments: 0\n\n        }\n      }\n    }\n\n\n    if (maxDepth > 1) {\n      for (let i = 0; i < transactions.length; i++) {\n\n\n        if (transactions[i].out[0].s3.length == 64 * 2) {\n          var pathArray = chunkString(transactions[i].out[0].s3, 64);\n          if (comments[pathArray[1]]) {\n            var sendAddress = comments[pathArray[1]].tx.in[0].e.a\n            var correctSendAddress = (sendAddress == transactions[i].out[1].e.a) || (sendAddress == transactions[i].out[2].e.a)\n            var selfComment = comments[pathArray[1]].tx.out[0].s6 == transactions[i].out[0].s6;\n            if (correctSendAddress && !selfComment) {\n              comments[pathArray[1]][transactions[i].tx.h] = {\n                tx: transactions[i],\n                comments: 0\n              }\n              comments[pathArray[1]].comments += 1\n\n            }\n\n          }\n\n\n        }\n      }\n\n    }\n\n    if (maxDepth > 2) {\n      for (let i = 0; i < transactions.length; i++) {\n        if (transactions[i].out[0].s3.length == 64 * 3) {\n          var pathArray = chunkString(transactions[i].out[0].s3, 64);\n          if (comments[pathArray[1]]) {\n            if (comments[pathArray[1]][pathArray[2]]) {\n              var sendAddress = comments[pathArray[1]][pathArray[2]].tx.in[0].e.a\n              var correctSendAddress = (sendAddress == transactions[i].out[1].e.a) || (sendAddress == transactions[i].out[2].e.a)\n              var selfComment = comments[pathArray[1]][pathArray[2]].tx.out[0].s6 == transactions[i].out[0].s6;\n              if (correctSendAddress && !selfComment) {\n                comments[pathArray[1]][pathArray[2]][transactions[i].tx.h] = {\n                  tx: transactions[i],\n                  comments: 0\n                }\n                comments[pathArray[1]][pathArray[2]].comments += 1\n              }\n\n            }\n          }\n        }\n      }\n\n    }\n\n    if (maxDepth > 3) {\n      for (let i = 0; i < transactions.length; i++) {\n        if (transactions[i].out[0].s3.length == 64 * 4) {\n          var pathArray = chunkString(transactions[i].out[0].s3, 64);\n          if (comments[pathArray[1]]) {\n            if (comments[pathArray[1]][pathArray[2]]) {\n              if (comments[pathArray[1]][pathArray[2]][pathArray[3]]) {\n                var sendAddress = comments[pathArray[1]][pathArray[2]][pathArray[3]].tx.in[0].e.a\n                var correctSendAddress = (sendAddress == transactions[i].out[1].e.a) || (sendAddress == transactions[i].out[2].e.a)\n\n                var selfComment = comments[pathArray[1]][pathArray[2]][pathArray[3]].tx.out[0].s6 == transactions[i].out[0].s6;\n                if (correctSendAddress && !selfComment) {\n                  comments[pathArray[1]][pathArray[2]][pathArray[3]][transactions[i].tx.h] = {\n                    tx: transactions[i],\n                    comments: 0\n                  }\n                  comments[pathArray[1]][pathArray[2]][pathArray[3]].comments += 1\n                }\n              }\n            }\n          }\n        }\n      }\n\n    }\n    if (maxDepth > 4) {\n      for (let i = 0; i < transactions.length; i++) {\n        if (transactions[i].out[0].s3.length == 64 * 5) {\n          var pathArray = chunkString(transactions[i].out[0].s3, 64);\n          if (comments[pathArray[1]]) {\n            if (comments[pathArray[1]][pathArray[2]]) {\n              if (comments[pathArray[1]][pathArray[2]][pathArray[3]]) {\n                if (comments[pathArray[1]][pathArray[2]][pathArray[3]][pathArray[4]]) {\n                  var sendAddress = comments[pathArray[1]][pathArray[2]][pathArray[3]][pathArray[4]].tx.in[0].e.a\n                  var correctSendAddress = (sendAddress == transactions[i].out[1].e.a) || (sendAddress == transactions[i].out[2].e.a)\n\n                  var selfComment = comments[pathArray[1]][pathArray[2]][pathArray[3]][pathArray[4]].tx.out[0].s6 == transactions[i].out[0].s6;\n                  if (correctSendAddress && !selfComment) {\n                    comments[pathArray[1]][pathArray[2]][pathArray[3]][pathArray[4]][transactions[i].tx.h] = {\n                      tx: transactions[i],\n                      comments: 0\n                    }\n                    comments[pathArray[1]][pathArray[2]][pathArray[3]][pathArray[4]].comments += 1\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n\n    }\n\n\n    this.setState({\n      comments: Object.values(comments),\n      showCommentsFor: rootPath\n\n    })\n\n\n  }\n\n  loadComments = (postTransaction) => {\n    var rootPath = postTransaction.tx.h\n    var query = { \"v\": 3, \"q\": { \"find\": { \"out.s1\": \"13beK8bifnhuC8pawWvMrPCaWoTQi5LnZf\", \"out.s2\": \"comment\", \"out.s3\": { \"$regex\": \".*\" + rootPath + \".*\" } } } };\n    var b64 = btoa(JSON.stringify(query));\n    var url = \"https://weekly.bitdb.network/q/12KQyEvGbHcJmavgmB1jDeTSJhJTzQ5ePg/\" + b64;\n\n\n    var header = {\n      headers: { key: \"1EsRL44h3xNm8G4hT35ns3nNPicAHWAftc\" }\n    };\n\n    fetch(url, header).then(function (r) {\n      return r.json()\n    }).then((r) => {\n      var result = JSON.stringify(r, null, 2);\n      result = JSON.parse(result);\n\n      var transactions = result.t;\n      this.processComments(transactions, postTransaction);\n\n      this.setState({\n        commentsTransactions: transactions,\n      }\n        // , () => this.createCommentsSocket(postTransaction)\n      )\n\n\n\n    })\n  }\n\n  createCommentsSocket = (postTransaction) => {\n\n    var rootPath = postTransaction.tx.h\n    var socketQuery = { \"v\": 3, \"q\": { \"find\": { \"out.s1\": \"13beK8bifnhuC8pawWvMrPCaWoTQi5LnZf\", \"out.s2\": \"comment\", \"out.s3\": { \"$regex\": \".*\" + rootPath + \".*\" } } } };\n\n    var b64 = btoa(JSON.stringify(socketQuery))\n    // Subscribe to EventSource\n    var url = \"https://chronos.bitdb.network/s/1P6o45vqLdo6X8HRCZk8XuDsniURmXqiXo/\" + b64;\n    this.commentsSocket = new EventSource(url)\n    // Handle new messages\n\n    this.commentsSocket.onmessage = (e) => {\n\n      var transactions = JSON.parse(JSON.stringify(JSON.parse(e.data), null, 2)).data\n\n      var updatedTransactions = this.state.commentsTransactions.concat(transactions)\n      if (this.state.showCommentsFor == postTransaction.tx.h) {\n        this.processComments(updatedTransactions, postTransaction)\n        this.setState({\n          commentsTransactions: updatedTransactions\n        });\n      }\n\n\n\n\n    }\n\n  }\n\n  toggleDateRange = () => {\n    var newState;\n    this.state.dateRange == 'today' ? newState = 'weekly' : newState = 'today';\n    this.setState({\n      mode: 'top',\n      dateRange: newState\n    }, () => {\n      this.loadPosts();\n    })\n  }\n\n  votePriceChangeHandler=()=>{\n    this.state.votePrice=localStorage.getItem('votePrice');\n    this.setState({\n      showLoginAlert:false,\n      changingVotePrice:false\n    })\n  }\n\n\n\n  render() {\n    \n    var postElements = [];\n    var posts = this.state.posts.slice()\n    var numTopPosts;\n    this.state.dateRange == 'today' ? numTopPosts = 10 : numTopPosts = 15;\n\n\n    if (this.state.mode == 'top') {\n      posts.sort((a, b) => {\n        if (a.reward == b.reward) {\n\n          return a.tx.timestamp - b.tx.timestamp;\n        } else {\n          return b.voters.length - a.voters.length\n        }\n\n      })\n      while (posts.length > numTopPosts) {\n        posts.pop()\n      }\n\n    } else {\n\n      posts.sort((a, b) => {\n        return b.tx.timestamp - a.tx.timestamp\n      })\n\n    }\n\n\n\n    for (let i = 0; i < posts.length; i++) {\n      postElements.push(<Post loggedIn={this.state.loggedIn} postData={posts[i]} comments={this.state.comments} showCommentsFor={this.state.showCommentsFor} toggleComments={this.toggleCommentsHandler} replyHandler={this.replyHandler} userId={this.state.userId} />)\n\n    }\n\n    var dropdown = (\n      \n          <div class=\"dropdown\">\n            <div class=\"header-button\" onClick={()=>this.setState({showLoginAlert:true,changingUsername:true, changingVotePrice:false, showDropdown:false})}>\n              <div class=\"header-button-text dropdown-text\">change username</div>\n            </div>\n            <div class=\"header-button dropdown-button\">\n              <div class=\"header-button-text dropdown-text\" onClick={()=>this.setState({showLoginAlert:true,changingUsername:false,showDropdown:false, changingVotePrice:true})}>change vote price<br /></div>\n            </div>\n          </div>\n       \n    )\n\n    var headerRight;\n    if (this.state.loggedIn) {\n      headerRight = (\n        <div className=\"header-right\" >\n          <div className=\"header-button\" onClick={() => this.setState({ showDropdown:!this.state.showDropdown})}>\n            <div className=\"header-button-text\" >{this.state.username}</div>\n            <div className=\"header-button-text button-symbol\">{this.state.showDropdown?'▼':'▶'}</div>\n          </div>\n          <div class=\"dropdown-container\">\n          {this.state.showDropdown?dropdown:null}\n          </div>\n        </div>\n\n      );\n    } else {\n      headerRight = (\n        <div className=\"header-right\">\n          <div className=\"header-button\" onClick={() => this.setState({ showLoginAlert: true })}>\n            <div className=\"header-button-text\" >login</div>\n          </div>\n        </div>\n      )\n    }\n\n    \n\n    \n\n\n\n    return (\n      <div>\n        {/* This site was created in Webflow. http://www.webflow.com */}\n        {/* Last Published: Sat Apr 20 2019 23:09:33 GMT+0000 (UTC) */}\n        <meta charSet=\"utf-8\" />\n        <title>bsvnews</title>\n        <meta content=\"width=device-width, initial-scale=1\" name=\"viewport\" />\n        <meta content=\"Webflow\" name=\"generator\" />\n        {/*[if lt IE 9]><![endif]*/}\n        <Helmet>\n        <title>bsvnews</title>\n        <script src=\"https://tonicpow.com/tonic.js\"></script>\n        </Helmet>\n\n\n        <div className=\"container w-container\" style={{ paddingBottom: 10 }}>\n          <div className=\"header\">\n            <div className=\"header-left\" >\n              <div className=\"title\">BSV News</div>\n              <div className='button-container'>\n                {this.state.dateRange == 'today' ? <div className=\"header-button\" onClick={this.switchMode}> <div className=\"header-button-text\"  >{this.state.mode == 'top' ? 'new' : 'top'} </div> </div> : null}\n                <div className=\"header-button\" onClick={this.submitHandler}> <div className=\"header-button-text\" >{this.state.posting ? \" X \" : \"submit\"}</div></div>\n                <div className=\"header-button\" onClick={this.loadPosts}> <div className=\"header-button-text\" >reload</div></div>\n                <div className=\"header-button\" onClick={this.toggleDateRange}> <div className=\"header-button-text\" >{this.state.dateRange == 'today' ? 'weekly' : 'today'}</div></div>\n\n              </div>\n            </div>\n\n            {headerRight}\n\n\n          </div>\n\n          {this.state.showLoginAlert ? <LoginAlert votePriceChangeHandler={this.votePriceChangeHandler} xHandler={this.hideLoginAlert} loginHandler={this.loginHandler} changingUsername={this.state.changingUsername} changingVotePrice={this.state.changingVotePrice} /> : null}\n          {this.state.posting ? <PostForm username={this.state.username} userId={this.state.userId} finishSubmitHandler={this.submitHandler} /> : null}\n          \n          <div className=\"posts\">\n            {postElements}\n          </div>\n\n          {this.state.replying ? <ReplyForm hideReply={this.hideReplyFormHandler} replyingTo={this.state.replyingTo} username={this.state.username} userId={this.state.userId} /> : null}\n          <div className='metadata' style={{ width: '100%', padding: 10, paddingBottom: 0, paddingRight: 20, display: 'flex', justifyContent: 'flex-end' }}> {this.state.votePrice} Created by $canyouhandleme</div>\n        </div>\n        <div className=\"tonic-pow\">\n        <div style={{margin:'auto'}} class=\"tonic\" data-address=\"1BvrRxhXAVsZKyMnBT1STkXXVnsXrm7BNm\"></div>\n        </div>\n        \n      </div>\n\n\n\n    );\n  }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}