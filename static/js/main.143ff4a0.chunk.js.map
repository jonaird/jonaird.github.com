{"version":3,"sources":["components/Comment.js","components/CommentsContainer.js","components/Post.js","components/LoginAlert.js","components/ReplyForm.js","components/PostForm.js","App.js","serviceWorker.js","index.js"],"names":["Comment","props","tx","Object","objectSpread","commentTree","path","out","s3","h","username","s5","address","in","e","a","showReplyButton","length","userId","s6","subcomments","comments","commentElements","values","sort","b","i","push","react_default","createElement","replyHandler","className","timeago","onClick","decodeURIComponent","s4","CommentContainer","commentsArray","slice","MoneyButton","require","default","convertToHex","str","hex","charCodeAt","toString","Post","_this","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","toggleCommentsHandler","setState","showComments","state","toggleTipHandler","loggedIn","tip","_this2","url","decodeURI","postData","title","showCommentsFor","selfPost","s7","previouslyVoted","voters","includes","showMoneyButton","previous","elapsed","Date","now","Math","round","msPerMinute","msPerHour","msPerDay","timeDifference","timestamp","rewardInSatoshis","reward","rewardInBitcoin","JSON","parse","moneyButton","style","height","outputs","amount","currency","type","script","to","editable","replyButton","tipToggle","cursor","window","open","toggleComments","width","display","alignItems","justifyContent","React","Component","LoginAlert","onPaymentHandler","payment","input","localStorage","setItem","loginHandler","console","log","inputOnChangeHandler","event","target","value","paymentAmount","changingUsername","id","name","data-name","xHandler","pointerEvents","onChange","maxLength","placeholder","LoginAlert_MoneyButton","onPayment","ReplyForm","inputChangeHandler","reply","replyingTo","hideReply","defaultValue","ReplyForm_MoneyButton","encodeURIComponent","PostForm","urlChangeHandler","titleChangeHandler","opReturn","opreturn","encodeURI","required","href","PostForm_MoneyButton","finishSubmitHandler","chunkString","len","_offset","_size","ceil","_ret","Array","_i","substring","App","processPostsVotes","transactions","posts","votes","filter","valid","RegExp","test","secondOutput","postTxid","correctAddress","correctAddressSecondOutput","voterId","prevVoters","selfVote","v","postsArray","loadPosts","b64","btoa","stringify","q","find","out.s1","out.s2","limit","dateRange","fetch","headers","key","then","r","json","result","t","createPostVoteSocket","EventSource","onmessage","data","hideLoginAlert","showLoginAlert","submitHandler","posting","replying","mode","switchMode","getItem","hideReplyFormHandler","postTransaction","loadComments","processComments","maxDepth","rootPath","sendAddress","correctSendAddress","selfComment","pathArray","query","out.s3","$regex","commentsTransactions","createCommentsSocket","socketQuery","commentsSocket","updatedTransactions","concat","toggleDateRange","newState","showDropdown","numTopPosts","postElements","pop","Post_Post","headerRight","dropdown","class","charSet","content","paddingBottom","LoginAlert_LoginAlert","PostForm_PostForm","ReplyForm_ReplyForm","padding","paddingRight","Boolean","location","hostname","match","ReactDOM","render","src_App_0","document","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.143ff4a0.chunk.js","sourcesContent":["import React from 'react';\n\nexport default function Comment(props) {\n\n  var tx={...props.commentTree.tx};\n\n  var path = tx.out[0].s3+tx.tx.h;\n  var username = tx.out[0].s5;\n  var address = tx.in[0].e.a\n  var showReplyButton = path.length/64<6 && props.userId!=tx.out[0].s6\n\n  var subcomments = {...props.commentTree};\n  delete subcomments.tx;\n  delete subcomments.comments;\n\n  subcomments = Object.values(subcomments);\n\n  var commentElements=[];\n\n  subcomments.sort(function(a,b){\n    return b.comments-a.comments;\n  })\n\n  for(let i=0;i<subcomments.length;i++){\n    commentElements.push(<Comment replyHandler={props.replyHandler} userId={props.userId} commentTree={subcomments[i]}/>)\n  }\n  \n\n  \n  return (\n    <div className=\"comment\">\n      <div className=\"comment-metadata\">\n\n        <div className=\"metadata\">{tx.out[0].s5}</div>\n        <div className=\"metadata\">{tx.timeago}</div>\n        {showReplyButton?<div className=\"metadata metadata-button\" onClick={() => props.replyHandler(path, username, address )}> reply</div>:null}\n      </div>\n      <div className=\"comment-content\">{decodeURIComponent(tx.out[0].s4)}</div>\n      {commentElements}\n    </div>\n  )\n}","import React from 'react';\nimport Comment from './Comment';\n\n\nexport default function CommentContainer(props){\n\n    var commentsArray = props.comments.slice();\n\n    commentsArray.sort(function (a,b){\n      return b.comments - a.comments;\n    })\n\n    var commentElements = [];\n    if(props.comments){\n      for(let i=0;i<props.comments.length;i++){\n        commentElements.push(<Comment replyHandler={props.replyHandler} userId={props.userId} commentTree={commentsArray[i]}/>)\n      }\n    }\n    \n\n    return(\n        <div className=\"comments-container\">\n          {commentElements}\n          {commentElements.length==0?\"No comments!\":null}\n        </div>\n    )\n}","import React from 'react';\nimport Comment from './Comment';\n\nimport CommentContainer from './CommentsContainer';\nlet MoneyButton = require('@moneybutton/react-money-button').default\n\nfunction convertToHex(str) {\n  var hex = '';\n  for (var i = 0; i < str.length; i++) {\n    hex += '' + str.charCodeAt(i).toString(16);\n  }\n  return hex;\n}\n\nfunction timeDifference(previous) {\n\n  var msPerMinute = 60 * 1000;\n  var msPerHour = msPerMinute * 60;\n  var msPerDay = msPerHour * 24;\n  var msPerMonth = msPerDay * 30;\n  var msPerYear = msPerDay * 365;\n\n  var elapsed = Date.now() - previous;\n\n  if (elapsed < msPerMinute) {\n       return Math.round(elapsed/1000) + ' seconds ago';   \n  }\n\n  else if (elapsed < msPerHour) {\n       return Math.round(elapsed/msPerMinute) + ' minutes ago';   \n  }\n\n  else if (elapsed < msPerDay ) {\n       return Math.round(elapsed/msPerHour ) + ' hours ago';   \n  }\n\n  else if (elapsed < msPerMonth) {\n      return Math.round(elapsed/msPerDay) + ' days ago';   \n  }\n\n  else if (elapsed < msPerYear) {\n      return Math.round(elapsed/msPerMonth) + ' months ago';   \n  }\n\n  else {\n      return Math.round(elapsed/msPerYear ) + ' years ago';   \n  }\n}\n\nexport default class Post extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n\n      showComments: false,\n      tip: false\n    }\n  }\n\n\n\n\n\n  toggleCommentsHandler = () => {\n    this.setState({\n      showComments: !this.state.showComments\n    })\n  }\n\n  toggleTipHandler=()=>{\n    if(this.props.loggedIn){\n      this.setState({ tip: !this.state.tip })\n    } else {\n      this.props.replyHandler()//prompts user to Login\n    }\n  }\n\n\n\n  render() {\n\n    var url = decodeURI(this.props.postData.tx.out[0].s5)\n    var title = decodeURIComponent(this.props.postData.tx.out[0].s4)\n    var username = this.props.postData.tx.out[0].s6\n    var showComments = this.props.showCommentsFor == this.props.postData.tx.tx.h\n    var selfPost = this.props.postData.tx.out[0].s7 == this.props.userId;\n    var previouslyVoted = this.props.postData.voters.includes(this.props.userId);\n    var showMoneyButton= !selfPost&& !previouslyVoted \n    var timeago;\n    this.props.postData.tx.timeago? timeago=this.props.postData.tx.timeago:timeago =timeDifference(this.props.postData.tx.timestamp);\n    \n\n\n    var rewardInSatoshis = this.props.postData.reward;\n    var rewardInBitcoin = JSON.parse(rewardInSatoshis / 100000000).toString();\n    var moneyButton = (<div style={{ height: 50 }} />)\n\n    if (this.props.loggedIn && !this.state.tip) {\n      moneyButton = (<MoneyButton\n\n        outputs={[\n          {\n            amount: 0,\n            currency: 'BSV',\n            type: 'SCRIPT',\n            script: 'OP_RETURN ' + convertToHex('13beK8bifnhuC8pawWvMrPCaWoTQi5LnZf') + ' ' + convertToHex('post/vote') + ' ' + convertToHex('vote') + ' ' + convertToHex(this.props.postData.tx.tx.h) + ' ' + convertToHex(this.props.userId)\n\n          }, {\n            to: this.props.postData.tx.in[0].e.a,\n            amount: '0.01',\n            currency: 'USD',\n\n\n          }\n\n        ]}\n\n\n      />)\n    } else if (this.props.loggedIn && this.state.tip) {\n      moneyButton = (<MoneyButton\n        to={this.props.postData.tx.in[0].e.a}\n        amount='0.01'\n        currency='BSV'\n        editable={true}\n      />)\n    }\n\n\n    if (rewardInBitcoin.length == 1) {\n      rewardInBitcoin += '.00000000'\n    } else if (rewardInBitcoin.length < 10) {\n      while (rewardInBitcoin.length < 10) {\n        rewardInBitcoin += '0'\n      }\n    }\n\n\n    var replyButton = (<div className=\"metadata metadata-button\" onClick={() => this.props.replyHandler(this.props.postData.tx.tx.h, username, this.props.postData.tx.in[0].e.a)}>reply</div>\n    )\n    var tipToggle = (<div className=\"metadata metadata-button\" onClick={this.toggleTipHandler}>{this.state.tip ? 'vote' : 'tip'}</div>\n    )\n\n    return (\n\n      <div className=\"post-container\"  >\n        <div className='post'>\n          <div>\n            <div className=\"post-data\">\n              <div className=\"reward\">{rewardInBitcoin}<strong>‚Çø</strong> </div>\n              <div className=\"post-title\" style={{ cursor: 'pointer' }} onClick={() => window.open(url)}>{title}</div>\n            </div>\n            <div className=\"post-metadata\">\n              <div className=\"metadata\"> ({timeago})</div>\n              <div className=\"metadata\">{username}</div>\n\n              <div className=\"metadata\" style={{ cursor: 'pointer' }} onClick={() => this.props.toggleComments(this.props.postData.tx)} > {showComments ? 'hide comments ‚ñº' : 'show comments ‚ñ∂'}</div>\n              \n              {selfPost ? null : [replyButton, tipToggle]}\n            </div>\n          </div>\n          {!showMoneyButton && !this.state.tip? <div style={{ height: 50, width:120, display:'flex',alignItems:'center', justifyContent:'center' }}>{previouslyVoted?\"Voted! üó≥Ô∏è\":null}</div> : <div style={{ width: this.state.tip ? 150 : 120, }} >\n            {moneyButton}\n          </div>}\n\n        </div>\n\n        {showComments ? <CommentContainer replyHandler={this.props.replyHandler} userId={this.props.userId} comments={this.props.comments} /> : null}\n      </div>\n\n\n\n    );\n  }\n}\n\n","import React from 'react';\nimport Cookies from 'universal-cookie';\nlet MoneyButton = require('@moneybutton/react-money-button').default\n\nexport default class LoginAlert extends React.Component{\n    constructor(props){\n        super(props);\n        this.state={\n            input:''\n        }\n    }\n\n    onPaymentHandler=(payment)=>{\n        \n        if(this.state.input!=''){\n            localStorage.setItem('userId', payment.userId.toString(), { path: '/' });\n            localStorage.setItem('username', this.state.input, { path: '/' });\n            this.props.loginHandler();\n        }\n        \n        console.log(payment.userId)\n        console.log(payment);\n    }\n\n    inputOnChangeHandler=(event)=>{\n        this.setState({\n            input:event.target.value\n        })\n    }\n\n\n    render(){\n      console.log(this.props.changingUsername);\n      var paymentAmount;\n      this.props.changingUsername?paymentAmount='1':paymentAmount='0.01'\n\n      return (\n        <div className=\"login-container\">\n            <div className=\"login-alert w-form\">\n              <form id=\"email-form-3\" name=\"email-form-3\" data-name=\"Email Form 3\" className=\"login-form\">\n                <div className=\"div-block-2\" onClick={this.props.xHandler}>\n                  <div className=\"login-cancel\" >X</div>\n                </div>\n                <div className=\"login-title\" style={{pointerEvents:'none'}} >Login</div>\n                    <input \n                        onChange={this.inputOnChangeHandler}\n                        type=\"text\" \n                        className=\"login-username w-input\" \n                        maxLength={256} name=\"name-2\" \n                        data-name=\"Name 2\" \n                        placeholder=\"Desired Username\" id=\"name-2\" />\n                <div className=\"mb-container\" ><MoneyButton\n                  to='112'\n                  amount={paymentAmount}\n                  currency='USD'\n                  onPayment={this.onPaymentHandler}\n                /></div>\n              </form>\n\n            </div>\n          </div>\n    );}\n}","import React from 'react';\nlet MoneyButton = require('@moneybutton/react-money-button').default\n\n var convertToHex=(str)=> {\n  var hex = '';\n  for (var i = 0; i < str.length; i++) {\n      hex += '' + str.charCodeAt(i).toString(16);\n  }\n  return hex;\n}\n\n\nexport default class ReplyForm extends React.Component {\n  constructor(props){\n    super(props);\n    this.state={\n      reply:''\n    }\n\n  }\n\n  inputChangeHandler=(e)=>{\n    this.setState({\n      reply:e.target.value\n    })\n    \n  }\n\n  render() {\n    return (\n      <div className=\"new-reply-container\">\n        <div className=\"new-reply-form w-form\">\n          <form id=\"email-form-2\" name=\"email-form-2\" data-name=\"Email Form 2\" className=\"form-2\">\n            <div className=\"div-block\">\n              <div>Replying to: {this.props.replyingTo.username}</div>\n              <div className=\"login-cancel\" onClick={this.props.hideReply}>X</div>\n            </div>\n            <textarea onChange={this.inputChangeHandler} id=\"field\" name=\"field\" placeholder=\"Example Text\" maxLength={5000} className=\"textarea w-input\" defaultValue={\"\"} />\n            <MoneyButton\n              outputs={[\n                {\n                  amount: 0,\n                  currency: 'BSV',\n                  type: 'SCRIPT',\n                  script: 'OP_RETURN ' + convertToHex('13beK8bifnhuC8pawWvMrPCaWoTQi5LnZf') + ' ' + convertToHex('comment') + ' ' + convertToHex(this.props.replyingTo.path) + ' ' + convertToHex(encodeURIComponent(this.state.reply)) + ' ' + convertToHex(this.props.username) +' ' + convertToHex(this.props.userId)\n\n                }, {\n                  to: this.props.replyingTo.address,\n                  amount: '0.01',\n                  currency: 'USD'\n\n                }\n              ]}\n              onPayment={this.props.hideReply}\n\n            />\n          </form>\n        </div>\n      </div>\n    )\n  }\n}","import React from 'react';\nlet MoneyButton = require('@moneybutton/react-money-button').default\n\nfunction convertToHex(str) {\n    var hex = '';\n    for (var i = 0; i < str.length; i++) {\n        hex += '' + str.charCodeAt(i).toString(16);\n    }\n    return hex;\n}\n\n\nexport default class PostForm extends React.Component {\n\n    constructor(props){\n        super(props);\n        this.state={\n            url:'',\n            title:'',\n            opReturn:''\n\n        }\n    }\n\n   \n\n\n    urlChangeHandler=(e)=>{\n        this.setState({\n            url:e.target.value\n        })\n    }\n\n    titleChangeHandler=(e)=>{\n        this.setState({\n            title:e.target.value\n        })\n        \n    }\n    // outputs={[\n    //     {   \n    //         amount:0,\n    //         currency:'BSV',\n    //         type:'SCRIPT',\n    //         script:'OP_RETURN ' + opreturn\n\n    //     },{\n    //         to:'1JM394PQB47chcs49PCe3JETLDaBwzieBP',\n    //         amount: '0.01',\n    //         currency: 'USD'\n\n    //     }\n    // ]}\n    render() {\n        var opreturn= convertToHex('13beK8bifnhuC8pawWvMrPCaWoTQi5LnZf')+ ' ' + convertToHex('post/vote') + ' ' + convertToHex('post')  + ' ' + convertToHex(encodeURIComponent(this.state.title))+ ' ' + convertToHex(encodeURI(this.state.url))+ ' ' + convertToHex(this.props.username) + ' ' + convertToHex(this.props.userId) \n        \n        return (\n            <div className=\"new-post w-form\">\n                <form id=\"email-form\" name=\"email-form\" data-name=\"Email Form\" className=\"form\">\n                    <input onChange={this.titleChangeHandler} type=\"text\" className=\"text-field w-input\" maxLength={256} name=\"name\" data-name=\"Name\" placeholder=\"Post Title\" id=\"name\" />\n                    <input onChange={this.urlChangeHandler} type=\"email\" className=\"text-field w-input\" maxLength={256} name=\"email\" data-name=\"Email\" placeholder=\"Post URL\" id=\"email\" required />\n                    <div className=\"text-block-7\">* Each post donates $0.01 to <a href=\"https://faucet.allaboard.cash/\" target=\"_blank\" className=\"link\">faucet.allaboard.cash</a></div>\n                    <MoneyButton\n                        to='1JM394PQB47chcs49PCe3JETLDaBwzieBP'\n                        amount= '0.01'\n                        currency= 'USD'\n                        opReturn={opreturn}\n                        editable={true}\n                        \n                        onPayment={this.props.finishSubmitHandler}\n                    />\n                </form>\n\n            </div>\n        );\n    }\n}","import React, { Component } from 'react';\nimport './App.css';\nimport Post from './components/Post.js';\nimport Cookies from 'universal-cookie';\nimport LoginAlert from './components/LoginAlert';\nimport ReplyForm from './components/ReplyForm';\nimport PostForm from './components/PostForm';\nlet MoneyButton = require('@moneybutton/react-money-button').default\n\nfunction chunkString(str, len) {\n  var _size = Math.ceil(str.length / len),\n    _ret = new Array(_size),\n    _offset\n    ;\n\n  for (var _i = 0; _i < _size; _i++) {\n    _offset = _i * len;\n    _ret[_i] = str.substring(_offset, _offset + len);\n  }\n\n  return _ret;\n}\n\nfunction validURL(str) {\n  var pattern = new RegExp('^(https?:\\\\/\\\\/)?' + // protocol\n    '((([a-z\\\\d]([a-z\\\\d-]*[a-z\\\\d])*)\\\\.)+[a-z]{2,}|' + // domain name\n    '((\\\\d{1,3}\\\\.){3}\\\\d{1,3}))' + // OR ip (v4) address\n    '(\\\\:\\\\d+)?(\\\\/[-a-z\\\\d%_.~+]*)*' + // port and path\n    '(\\\\?[;&a-z\\\\d%_.~+=-]*)?' + // query string\n    '(\\\\#[-a-z\\\\d_]*)?$', 'i'); // fragment locator\n  return !!pattern.test(str);\n}\n\n\nclass App extends Component {\n\n\n  constructor(props) {\n    super(props);\n    //this.cookies = new Cookies();\n    const username = localStorage.getItem('username');\n    const userId = localStorage.getItem('userId');\n    console.log(userId,username);\n\n    var state = {\n      showLoginAlert: false,\n      showDropdown:false,\n      changingUsername:false,\n      loggedIn: false,\n      replying: false,\n      replyingTo: null,\n      posting: false,\n      showCommentsFor: null,\n      commentsTransactions: null,\n      comments: null,\n      mode: 'top',\n      dateRange: 'today',\n      userId: null,\n      username: null,\n      transactions: [],\n      posts: []\n    }\n\n    if (username && userId) {\n      state.username = username;\n      state.userId = userId;\n      state.loggedIn = true;\n    }\n    this.state = state;\n    this.loadPosts();\n    this.createPostVoteSocket();\n\n  }\n\n\n\n\n\n  processPostsVotes = (transactions) => {\n    //make sure there are the right number of pushdata's\n\n    var posts = {};\n    var votes = [];\n\n    //filter invalid tx's and separate posts from votes\n    var transactions = transactions.filter(tx => {\n      var valid = false\n      if (tx.out[0].s3) {\n        if (tx.out[0].s3 == 'post') {\n          //checks for the right number of pushdata's\n          valid = tx.out[0].s7 && (validURL(decodeURI(tx.out[0].s5)) || decodeURI(tx.out[0].s5).includes('medium'))\n          if (valid) {\n            //donation sometimes happens in second output\n            var secondOutput = false\n            if (tx.out[2]) {\n              secondOutput = tx.out[2].e.a == '1JM394PQB47chcs49PCe3JETLDaBwzieBP'\n            }\n            //checks both outputs for donation\n            var donated = tx.out[1].e.a == '1JM394PQB47chcs49PCe3JETLDaBwzieBP' | secondOutput\n            //adds valid post to posts object\n            if (donated) {\n              posts[tx.tx.h] = { tx: tx, reward: 0, voters: [] }\n\n            }\n\n          }\n\n\n        } else if (tx.out[0].s3 == 'vote') {\n          valid = tx.out[0].s5;\n          if (valid) {\n            votes.push(tx);\n\n          }\n\n        }\n\n      }\n      return valid;\n    })\n    console.log('votes', votes)\n    console.log(posts);\n\n    //old code for processing transactions. very inefficient\n\n    // let posts = {}\n    // for (let i = 0; i < transactions.length; i++) {\n\n    //   if (transactions[i].out[0].s3 == 'post') {\n    //     var secondOutput = false\n    //     if (transactions[i].out[2]) {\n    //       secondOutput = transactions[i].out[2].e.a == '1JM394PQB47chcs49PCe3JETLDaBwzieBP'\n    //     }\n    //     var donated = transactions[i].out[1].e.a == '1JM394PQB47chcs49PCe3JETLDaBwzieBP' | secondOutput\n    //     if (donated) {\n    //       posts[transactions[i].tx.h] = { tx: transactions[i], reward: 0, voters: [] }\n\n    //     }\n    //   }\n    // }\n\n    // for (let i = 0; i < posts.length; i++) {\n\n\n    // }\n\n    //loop through votes to assign them properly\n    for (let i = 0; i < votes.length; i++) {\n      //does vote have corresponding post?\n      var postTxid = votes[i].out[0].s4\n      if (posts[postTxid]) {\n        var correctAddress = posts[postTxid].tx.in[0].e.a == votes[i].out[1].e.a;\n        var correctAddressSecondOutput = false;\n        if (votes[i].out[2]) {\n          correctAddressSecondOutput = posts[postTxid].tx.in[0].e.a == votes[i].out[2].e.a;\n        }\n\n        correctAddress = correctAddress || correctAddressSecondOutput;\n        var voterId = votes[i].out[0].s5;\n        var prevVoters = posts[postTxid].voters;\n        var selfVote = voterId == posts[postTxid].tx.out[0].s7;\n\n        if (correctAddress && !prevVoters.includes(voterId) && !selfVote) {\n          //tabulating upvote total\n          correctAddressSecondOutput ? posts[postTxid].reward += votes[i].out[2].e.v : posts[postTxid].reward += votes[i].out[1].e.v;\n          prevVoters.push(voterId) // keeps track of unique voters\n\n        }\n      }\n    }\n\n\n\n    //start comment out\n    // var postsKeys = Object.keys(posts);\n\n    // //loop through posts\n    // for (let i = 0; i < postsKeys.length; i++) {\n    //   //loop through transactions to find upvotes for specific post\n    //   for (let j = 0; j < transactions.length; j++) {\n    //     //is upvote and is upvote for current post?\n    //     if (transactions[j].out[0].s4 == postsKeys[i]) {\n    //       var correctAddress = posts[postsKeys[i]].tx.in[0].e.a == transactions[j].out[1].e.a;\n\n    //       var correctAddressSecondOutput = false;\n    //       if (transactions[j].out[2]) {\n    //         correctAddressSecondOutput = posts[postsKeys[i]].tx.in[0].e.a == transactions[j].out[2].e.a;\n    //       }\n\n    //       var voterId = transactions[j].out[0].s5;\n    //       var prevVoters = posts[postsKeys[i]].voters;\n    //       var selfVote = voterId == posts[postsKeys[i]].tx.out[0].s7;\n    //       //TODO: var selfVote = do a self vote check\n\n    //       if (correctAddress && !prevVoters.includes(voterId) && !selfVote) {\n    //         //tabulating upvote total\n    //         posts[postsKeys[i]].reward += transactions[j].out[1].e.v;\n    //         prevVoters.push(voterId) // keeps track of unique voters\n\n    //       } else if (correctAddressSecondOutput && !prevVoters.includes(voterId) && !selfVote) {\n    //         posts[postsKeys[i]].reward += transactions[j].out[2].e.v;\n    //         prevVoters.push(voterId)\n    //       }\n\n    //     }\n    //   }\n    // }\n\n    var postsArray = Object.values(posts)\n\n\n\n\n    this.setState({\n      posts: postsArray\n    })\n\n  }\n\n\n\n  loadPosts = () => {\n\n\n    var query = { \"v\": 3, \"q\": { \"find\": { \"out.s1\": \"13beK8bifnhuC8pawWvMrPCaWoTQi5LnZf\", \"out.s2\": \"post/vote\" }, \"limit\": 1000 } };\n    var b64 = btoa(JSON.stringify(query));\n    var url;\n    if (this.state.dateRange == \"today\") {\n      url = \"https://chronos.bitdb.network/q/1P6o45vqLdo6X8HRCZk8XuDsniURmXqiXo/\" + b64;\n    } else {\n      url = \"https://weekly.bitdb.network/q/12KQyEvGbHcJmavgmB1jDeTSJhJTzQ5ePg/\" + b64;\n\n    }\n\n\n    var header = {\n      headers: { key: \"1EsRL44h3xNm8G4hT35ns3nNPicAHWAftc\" }\n    };\n\n    fetch(url, header).then(function (r) {\n      return r.json()\n    }).then((r) => {\n      var result = JSON.stringify(r, null, 2);\n      result = JSON.parse(result);\n\n      var transactions = result.t;\n\n      console.log(transactions);\n\n      this.processPostsVotes(transactions);\n      this.setState({\n        transactions\n      })\n\n\n    })\n  }\n\n  createPostVoteSocket = () => {\n\n    var socketQuery = { \"v\": 3, \"q\": { \"find\": { \"out.s1\": \"13beK8bifnhuC8pawWvMrPCaWoTQi5LnZf\", \"out.s2\": \"post/vote\" } } };\n\n    var b64 = btoa(JSON.stringify(socketQuery))\n    // Subscribe to EventSource\n    var url = \"https://chronos.bitdb.network/s/1P6o45vqLdo6X8HRCZk8XuDsniURmXqiXo/\" + b64;\n    var socket = new EventSource(url)\n    // Handle new messages\n\n    socket.onmessage = (e) => {\n\n      var transactions = JSON.parse(JSON.stringify(JSON.parse(e.data), null, 2)).data\n      if (transactions.length > 0) {\n        this.loadPosts()\n      }\n\n      // var updatedTransactions = this.state.transactions.concat(transactions)\n      // this.processPostsVotes(updatedTransactions)\n      // this.setState({\n      //   transactions: updatedTransactions\n      // });\n\n\n\n\n    }\n\n  }\n\n\n\n  hideLoginAlert = () => {\n    this.setState({\n      showLoginAlert: false\n    })\n  }\n\n  submitHandler = () => {\n    if (!this.state.loggedIn) {\n      this.setState({\n        showLoginAlert: true\n      })\n    } else if (this.state.posting == true) {\n      this.setState({\n        posting: false\n      })\n    }\n    else {\n      this.setState({\n        replying: false,\n        posting: true,\n        mode: 'new',\n        dateRange: 'today'\n      }, this.loadPosts\n      );\n\n    }\n  }\n\n  switchMode = () => {\n    this.loadPosts();\n    if (this.state.mode == 'top') {\n      this.setState({ mode: 'new' })\n    } else {\n      this.setState({ mode: 'top' })\n    }\n  }\n\n  loginHandler = () => {\n    this.setState({\n      loggedIn: true,\n      userId: localStorage.getItem('userId'),\n      username: localStorage.getItem('username')\n    })\n    this.hideLoginAlert();\n  }\n\n  replyHandler = (path, username, address) => {\n    if (this.state.loggedIn) {\n      this.setState({\n        replying: true,\n        replyingTo: {\n          path,\n          username,\n          address\n        }\n      })\n    } else {\n      this.setState({ showLoginAlert: true });\n    }\n\n  }\n\n  hideReplyFormHandler = () => {\n    this.setState({\n      replying: false,\n      replyingTo: null\n    })\n  }\n\n  toggleCommentsHandler = (postTransaction) => {\n    if (this.state.showCommentsFor == postTransaction.tx.h) {\n      // this.commentsSocket = null;\n      this.setState({\n        showCommentsFor: null\n      })\n    } else {\n      //this.commentsSocket = null;\n      this.loadComments(postTransaction);\n\n\n\n    }\n\n\n  }\n\n  processComments = (transactions, postTransaction) => {\n    var transactions = transactions.filter(tx => {\n      var valid = false\n      if (tx.out[0].s6) {\n        valid = true\n      }\n\n\n      return valid;\n    })\n\n\n    var comments = {};\n    var maxDepth = 0;\n    var rootPath = postTransaction.tx.h;\n    var sendAddress = postTransaction.in[0].e.a\n\n\n    //loops to find comments of depth=1 and adds to comments object\n    for (let i = 0; i < transactions.length; i++) {\n      var correctSendAddress = (sendAddress == transactions[i].out[1].e.a) || (sendAddress == transactions[i].out[2].e.a);\n      var selfComment = transactions[i].out[0].s6 == postTransaction.out[0].s7;\n\n      if (transactions[i].out[0].s3.length / 64 > maxDepth) {\n        maxDepth = transactions[i].out[0].s3.length / 64;\n      }\n      if (transactions[i].out[0].s3 == postTransaction.tx.h && correctSendAddress && !selfComment) {\n\n        comments[transactions[i].tx.h] = {\n          tx: transactions[i],\n          comments: 0\n\n        }\n      }\n    }\n\n\n    if (maxDepth > 1) {\n      for (let i = 0; i < transactions.length; i++) {\n\n\n        if (transactions[i].out[0].s3.length == 64 * 2) {\n          var pathArray = chunkString(transactions[i].out[0].s3, 64);\n          if (comments[pathArray[1]]) {\n            var sendAddress = comments[pathArray[1]].tx.in[0].e.a\n            var correctSendAddress = (sendAddress == transactions[i].out[1].e.a) || (sendAddress == transactions[i].out[2].e.a)\n            var selfComment = comments[pathArray[1]].tx.out[0].s6 == transactions[i].out[0].s6;\n            if (correctSendAddress && !selfComment) {\n              comments[pathArray[1]][transactions[i].tx.h] = {\n                tx: transactions[i],\n                comments: 0\n              }\n              comments[pathArray[1]].comments += 1\n\n            }\n\n          }\n\n\n        }\n      }\n\n    }\n\n    if (maxDepth > 2) {\n      for (let i = 0; i < transactions.length; i++) {\n        if (transactions[i].out[0].s3.length == 64 * 3) {\n          var pathArray = chunkString(transactions[i].out[0].s3, 64);\n          if (comments[pathArray[1]]) {\n            if (comments[pathArray[1]][pathArray[2]]) {\n              var sendAddress = comments[pathArray[1]][pathArray[2]].tx.in[0].e.a\n              var correctSendAddress = (sendAddress == transactions[i].out[1].e.a) || (sendAddress == transactions[i].out[2].e.a)\n              var selfComment = comments[pathArray[1]][pathArray[2]].tx.out[0].s6 == transactions[i].out[0].s6;\n              if (correctSendAddress && !selfComment) {\n                comments[pathArray[1]][pathArray[2]][transactions[i].tx.h] = {\n                  tx: transactions[i],\n                  comments: 0\n                }\n                comments[pathArray[1]][pathArray[2]].comments += 1\n              }\n\n            }\n          }\n        }\n      }\n\n    }\n\n    if (maxDepth > 3) {\n      for (let i = 0; i < transactions.length; i++) {\n        if (transactions[i].out[0].s3.length == 64 * 4) {\n          var pathArray = chunkString(transactions[i].out[0].s3, 64);\n          if (comments[pathArray[1]]) {\n            if (comments[pathArray[1]][pathArray[2]]) {\n              if (comments[pathArray[1]][pathArray[2]][pathArray[3]]) {\n                var sendAddress = comments[pathArray[1]][pathArray[2]][pathArray[3]].tx.in[0].e.a\n                var correctSendAddress = (sendAddress == transactions[i].out[1].e.a) || (sendAddress == transactions[i].out[2].e.a)\n\n                var selfComment = comments[pathArray[1]][pathArray[2]][pathArray[3]].tx.out[0].s6 == transactions[i].out[0].s6;\n                if (correctSendAddress && !selfComment) {\n                  comments[pathArray[1]][pathArray[2]][pathArray[3]][transactions[i].tx.h] = {\n                    tx: transactions[i],\n                    comments: 0\n                  }\n                  comments[pathArray[1]][pathArray[2]][pathArray[3]].comments += 1\n                }\n              }\n            }\n          }\n        }\n      }\n\n    }\n    if (maxDepth > 4) {\n      for (let i = 0; i < transactions.length; i++) {\n        if (transactions[i].out[0].s3.length == 64 * 5) {\n          var pathArray = chunkString(transactions[i].out[0].s3, 64);\n          if (comments[pathArray[1]]) {\n            if (comments[pathArray[1]][pathArray[2]]) {\n              if (comments[pathArray[1]][pathArray[2]][pathArray[3]]) {\n                if (comments[pathArray[1]][pathArray[2]][pathArray[3]][pathArray[4]]) {\n                  var sendAddress = comments[pathArray[1]][pathArray[2]][pathArray[3]][pathArray[4]].tx.in[0].e.a\n                  var correctSendAddress = (sendAddress == transactions[i].out[1].e.a) || (sendAddress == transactions[i].out[2].e.a)\n\n                  var selfComment = comments[pathArray[1]][pathArray[2]][pathArray[3]][pathArray[4]].tx.out[0].s6 == transactions[i].out[0].s6;\n                  if (correctSendAddress && !selfComment) {\n                    comments[pathArray[1]][pathArray[2]][pathArray[3]][pathArray[4]][transactions[i].tx.h] = {\n                      tx: transactions[i],\n                      comments: 0\n                    }\n                    comments[pathArray[1]][pathArray[2]][pathArray[3]][pathArray[4]].comments += 1\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n\n    }\n\n\n    this.setState({\n      comments: Object.values(comments),\n      showCommentsFor: rootPath\n\n    })\n\n\n  }\n\n  loadComments = (postTransaction) => {\n    var rootPath = postTransaction.tx.h\n    var query = { \"v\": 3, \"q\": { \"find\": { \"out.s1\": \"13beK8bifnhuC8pawWvMrPCaWoTQi5LnZf\", \"out.s2\": \"comment\", \"out.s3\": { \"$regex\": \".*\" + rootPath + \".*\" } } } };\n    var b64 = btoa(JSON.stringify(query));\n    var url = \"https://weekly.bitdb.network/q/12KQyEvGbHcJmavgmB1jDeTSJhJTzQ5ePg/\" + b64;\n\n\n    var header = {\n      headers: { key: \"1EsRL44h3xNm8G4hT35ns3nNPicAHWAftc\" }\n    };\n\n    fetch(url, header).then(function (r) {\n      return r.json()\n    }).then((r) => {\n      var result = JSON.stringify(r, null, 2);\n      result = JSON.parse(result);\n\n      var transactions = result.t;\n      this.processComments(transactions, postTransaction);\n\n      this.setState({\n        commentsTransactions: transactions,\n      }\n        // , () => this.createCommentsSocket(postTransaction)\n      )\n\n\n\n    })\n  }\n\n  createCommentsSocket = (postTransaction) => {\n\n    var rootPath = postTransaction.tx.h\n    var socketQuery = { \"v\": 3, \"q\": { \"find\": { \"out.s1\": \"13beK8bifnhuC8pawWvMrPCaWoTQi5LnZf\", \"out.s2\": \"comment\", \"out.s3\": { \"$regex\": \".*\" + rootPath + \".*\" } } } };\n\n    var b64 = btoa(JSON.stringify(socketQuery))\n    // Subscribe to EventSource\n    var url = \"https://chronos.bitdb.network/s/1P6o45vqLdo6X8HRCZk8XuDsniURmXqiXo/\" + b64;\n    this.commentsSocket = new EventSource(url)\n    // Handle new messages\n\n    this.commentsSocket.onmessage = (e) => {\n\n      var transactions = JSON.parse(JSON.stringify(JSON.parse(e.data), null, 2)).data\n\n      var updatedTransactions = this.state.commentsTransactions.concat(transactions)\n      if (this.state.showCommentsFor == postTransaction.tx.h) {\n        this.processComments(updatedTransactions, postTransaction)\n        this.setState({\n          commentsTransactions: updatedTransactions\n        });\n      }\n\n\n\n\n    }\n\n  }\n\n  toggleDateRange = () => {\n    var newState;\n    this.state.dateRange == 'today' ? newState = 'weekly' : newState = 'today';\n    this.setState({\n      mode: 'top',\n      dateRange: newState\n    }, () => {\n      this.loadPosts();\n    })\n  }\n\n\n\n  render() {\n    var postElements = [];\n    var posts = this.state.posts.slice()\n    var numTopPosts;\n    this.state.dateRange == 'today' ? numTopPosts = 10 : numTopPosts = 15;\n\n\n    if (this.state.mode == 'top') {\n      posts.sort((a, b) => {\n        if (a.reward == b.reward) {\n\n          return a.tx.timestamp - b.tx.timestamp;\n        } else {\n          return b.reward - a.reward\n        }\n\n      })\n      while (posts.length > numTopPosts) {\n        posts.pop()\n      }\n\n    } else {\n\n      posts.sort((a, b) => {\n        return b.tx.timestamp - a.tx.timestamp\n      })\n\n    }\n\n\n\n    for (let i = 0; i < posts.length; i++) {\n      postElements.push(<Post loggedIn={this.state.loggedIn} postData={posts[i]} comments={this.state.comments} showCommentsFor={this.state.showCommentsFor} toggleComments={this.toggleCommentsHandler} replyHandler={this.replyHandler} userId={this.state.userId} />)\n\n    }\n\n    var dropdown = (\n      \n          <div class=\"dropdown\">\n            <div class=\"header-button\">\n              <div class=\"header-button-text dropdown-text\">change username</div>\n            </div>\n            <div class=\"header-button dropdown-button\">\n              <div class=\"header-button-text dropdown-text\">change vote price<br /></div>\n            </div>\n          </div>\n       \n    )\n\n    var headerRight;\n    if (this.state.loggedIn) {\n      headerRight = (\n        <div className=\"header-right\" >\n          <div className=\"header-button\" onClick={() => this.setState({ showDropdown:!this.state.showDropdown})}>\n            <div className=\"header-button-text\" >{this.state.username}</div>\n            <div className=\"header-button-text button-symbol\">{this.state.showDropdown?'‚ñº':'‚ñ∂'}</div>\n          </div>\n          <div class=\"dropdown-container\">\n          {this.state.showDropdown?dropdown:null}\n          </div>\n        </div>\n\n      );\n    } else {\n      headerRight = (\n        <div className=\"header-right\">\n          <div className=\"header-button\" onClick={() => this.setState({ showLoginAlert: true })}>\n            <div className=\"header-button-text\" >login</div>\n          </div>\n        </div>\n      )\n    }\n\n    \n\n    \n\n\n\n    return (\n      <div>\n        {/* This site was created in Webflow. http://www.webflow.com */}\n        {/* Last Published: Sat Apr 20 2019 23:09:33 GMT+0000 (UTC) */}\n        <meta charSet=\"utf-8\" />\n        <title>bsvnews</title>\n        <meta content=\"width=device-width, initial-scale=1\" name=\"viewport\" />\n        <meta content=\"Webflow\" name=\"generator\" />\n        {/*[if lt IE 9]><![endif]*/}\n\n\n        <div className=\"container w-container\" style={{ paddingBottom: 10 }}>\n          <div className=\"header\">\n            <div className=\"header-left\" >\n              <div className=\"title\">BSV News</div>\n              <div className='button-container'>\n                {this.state.dateRange == 'today' ? <div className=\"header-button\" onClick={this.switchMode}> <div className=\"header-button-text\"  >{this.state.mode == 'top' ? 'new' : 'top'} </div> </div> : null}\n                <div className=\"header-button\" onClick={this.submitHandler}> <div className=\"header-button-text\" >{this.state.posting ? \" X \" : \"submit\"}</div></div>\n                <div className=\"header-button\" onClick={this.loadPosts}> <div className=\"header-button-text\" >reload</div></div>\n                <div className=\"header-button\" onClick={this.toggleDateRange}> <div className=\"header-button-text\" >{this.state.dateRange == 'today' ? 'weekly' : 'today'}</div></div>\n\n              </div>\n            </div>\n\n            {headerRight}\n\n\n          </div>\n\n          {this.state.showLoginAlert ? <LoginAlert xHandler={this.hideLoginAlert} loginHandler={this.loginHandler} changingUsername={this.state.changingUsername} /> : null}\n          {this.state.posting ? <PostForm username={this.state.username} userId={this.state.userId} finishSubmitHandler={this.submitHandler} /> : null}\n\n          <div className=\"posts\">\n            {postElements}\n          </div>\n\n          {this.state.replying ? <ReplyForm hideReply={this.hideReplyFormHandler} replyingTo={this.state.replyingTo} username={this.state.username} userId={this.state.userId} /> : null}\n          <div className='metadata' style={{ width: '100%', padding: 10, paddingBottom: 0, paddingRight: 20, display: 'flex', justifyContent: 'flex-end' }}> localStorage update Created by $canyouhandleme</div>\n        </div>\n\n      </div>\n\n\n\n    );\n  }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}